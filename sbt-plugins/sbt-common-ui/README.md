sbt-common-ui
===================

SBT plugin that enables sharing UI components via a common UI SBT subproject.

See the `example` project for detailed usage.

## Getting Started ##

To start using the `sbt-common-ui` plugin, you first must add it as a plugin to your SBT project:

In `[project root]/project/plugins.sbt`, add the following:

    val nexus = "http://utility.allenai.org:8081/nexus/content/repositories/releases"

    credentials += Credentials(
      "Sonatype Nexus Repository Manager",
      "utility.allenai.org",
      <username>,
      <password>)

    resolvers += "AllenAI" at nexus

    addSbtPlugin("org.allenai.plugins" % "sbt-common-ui" % <VERSION>)

Now you can use the plugin in your build file (either `build.sbt` or `project/Build.scala`). You will need to define subprojects - one for the common UI subproject, and one for each UI subroject that will depend on the common UI project.

```scala
// In build.sbt

// The common project (name is arbitrary)
lazy val commonUi = project.in(file("common-ui"))
  .settings(CommonUiPlugin.commonProjectSettings: _*)

// A UI project that depends on common
lazy val frontend = project.in(file("frontend"))
  .dependsOn(commonUi)
  .settings(CommonUiPlugin.dependentProjectSettings(commonUi): _*)

// Another UI project that depends on common
lazy val anotherFrontend = project.in(file("another-frontend"))
  .dependsOn(commonUi)
  .settings(CommonUiPlugin.dependentProjectSettings(commonUi): _*)
```

### UI Project Directory Structure ###

The `sbt-common-ui` plugin leverages Typesafe's [sbt-jshint-plugin](https://github.com/typesafehub/sbt-jshint-plugin) which in turn depends on Typesafe's [sbt-web](https://github.com/typesafehub/sbt-web) plugin infrastructure for javascript execution and web asset directory conventions. We are using the default's defined by `sbt-web`, which means that a UI project should put all managed HTML, CSS, and JS in a `src/main/assets/` directory. The directory can have any subdirectories, but as a convention, we will use:

```
src/main/assets         # managed sources (will be run through sbt-web plugins)
               /js      # javascript sources
               /css     # CSS sources
               /html    # HTML sources
               /images  # image files

src/main/public         # unmanaged sources (will just be copied to managed resources as is)
```

### Using Common Project Assets from a Dependent Project ###

The path to SBT _managed resource_ assets generated by a common UI project will be accessible at:

```
/public/common/[path/to/resource]
```

where the `[path/to/resource]` is the path after `/src/main/assets/` or `/src/main/public` in the common UI project.

In a Spray app, you'll want to define an `assets` route that will serve web assets like so:

```scala
def routes =
  path("assets" / Rest) { rest =>
    getFromResource(s"public/$rest")
  }
```

This will serve assets generated by the common UI project as well as the current dependent subproject. For example, to use a javscript file from a common UI project where the source is in:

`common-ui/src/main/assets/js/common.js`

You would add a `script` tag in your dependent project HTML file:

```html
<!-- in frontend/src/main/public/index.html -->
<html>
  <head>
    <!-- Import the common JS file -->
    <script src="/assets/common/js/common.js"></script>

    <!-- Import this project's main JS file which depends on the common JS file -->
    <script src="/assets/js/frontend.js"></script>
  </head>
  ...
</html>
```
